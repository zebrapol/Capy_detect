# Проект: Обнаружение капибар на изображениях с использованием машинного обучения

## Функционал

---

### 1. Сбор и обработка данных

#### `images_to_csv.py`

```python
def images_to_csv(folder_path, output_csv):
    """
    Конвертирует изображения в CSV-файл
    Параметры:
        folder_path: путь к папке с изображениями
        output_csv: имя выходного файла
    """
    # ... реализация ...
```

**Особенности:**

- Поддержка форматов: PNG, JPG, JPEG  
- Автоматическое ресайзинг до 15x15px  
- Сохранение в CSV (1 строка = 1 изображение)  

---

#### `web_scraping.py`

**Источники данных:**

- iNaturalist (капибары)  
- Unsplash (фоновые изображения)

**Функции:**

- Автопрокрутка страниц  
- Фильтрация по разрешению (>300px)  
- Сохранение с уникальными именами  

---

### 2.  Обучение модели

#### `train_model.py`

```python
# Параметры обучения
parameters = {
    'gamma': [0.01, 0.001, 0.0001],
    'C': [1, 10, 100, 1000]
}
```

**Метрики:**

- Accuracy: **92.5%**

**Особенности:**

- Использует SVM с GridSearch  
- Автоматическое разделение данных (80/20)  
- Экспорт модели в **TFLite** для Android  

---

### 3. Android-приложение

**Основные компоненты:**

| Компонент     | Назначение                        |
|---------------|-----------------------------------|
| MainActivity  | UI + обработка разрешений         |
| Model         | Загрузка и выполнение модели      |
| ImageUtils    | Конвертация Uri → Bitmap          |

---

**Workflow:**

1. Пользователь выбирает изображение  
2. Приложение преобразует его в тензор  
3. Модель возвращает предсказание (0/1)

---

##  Подробное описание

###  Алгоритм работы модели

#### Предобработка изображения:

- Ресайз до 15x15px  
- Нормализация пикселей (0–1)  
- Выравнивание в 1D вектор (675 features)

#### Классификация:

```python
# Псевдокод предсказания
def predict(image):
    processed = preprocess(image)
    prediction = model.predict(processed)
    return "Капибара" if prediction == 1 else "Не капибара"
```

---

###  Android-спецификации

**Минимальные требования:**

- Android 5.0+ (API 21)  
- Разрешение: `READ_EXTERNAL_STORAGE`  
- Поддержка `TFLite`

**Особенности реализации:**

```java
// Пример вызова модели
try (Model model = new Model(context)) {
    String result = model.predictFromUri(imageUri);
    showResult(result); 
}
```

### Установка и запуск
#### 1. Клонировать проект

```git clone https://github.com/zebrapol/Capy_detect.git
    git checkout mobile_capy
```

- Открыть в Android Studio
- Выберите "Open an existing project" и укажите путь к проекту
- Убедитесь, что в build.gradle добавлены зависимости для TensorFlow Lite:

```
implementation 'org.tensorflow:tensorflow-lite:2.5.0'
```
- Поместите файл модели model.tflite в папку assets/ (если отсутствует)

- Запустите приложение на устройстве или эмуляторе

